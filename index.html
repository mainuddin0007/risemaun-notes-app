<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RiseMaun Notes (with Feedback)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap');
        :root {
            --primary-bg: #FFFFFF; --secondary-bg: #F7F9FC; --primary-text: #1a1d21;
            --secondary-text: #5f6368; --accent-color: #1a73e8; --border-color: #DFE1E5;
            --danger-color: #d93025;
        }
        .dark-mode {
            --primary-bg: #1f1f1f; --secondary-bg: #282828; --primary-text: #e8eaed;
            --secondary-text: #969ba1; --accent-color: #8ab4f8; --border-color: #3c4043;
            --danger-color: #f28b82;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--secondary-bg); color: var(--primary-text); height: 100vh; display: flex; flex-direction: column; transition: background-color 0.3s, color 0.3s; }
        .app-header { display: flex; align-items: center; gap: 15px; padding: 10px 20px; background-color: var(--primary-bg); border-bottom: 1px solid var(--border-color); flex-shrink: 0; }
        .app-header button { background: none; border: none; padding: 8px; cursor: pointer; border-radius: 6px; font-size: 1.2rem; color: var(--secondary-text); }
        .app-header button:hover { background-color: var(--secondary-bg); }
        .header-group-right { margin-left: auto; display: flex; align-items: center; gap: 15px; }
        #save-status { font-size: 0.9rem; color: var(--secondary-text); font-weight: 500; transition: color 0.3s; }
        .main-editor { flex-grow: 1; padding: 20px; overflow-y: auto; }
        .editor-content-wrapper { max-width: 850px; margin: 0 auto; }
        #note-title { width: 100%; border: none; background: none; font-size: 2.5rem; font-weight: 600; padding: 20px 0; color: var(--primary-text); }
        #formatting-toolbar { display: flex; align-items: center; gap: 5px; flex-wrap: wrap; padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 30px; background-color: var(--primary-bg); }
        #formatting-toolbar button { background: none; border: 1px solid transparent; padding: 8px; cursor: pointer; border-radius: 6px; min-width: 40px; font-size: 1rem; color: var(--secondary-text); }
        #formatting-toolbar button:hover { background-color: var(--secondary-bg); }
        .toolbar-separator { width: 1px; height: 24px; background-color: var(--border-color); margin: 0 10px; }
        #note-content { font-size: 1.1rem; line-height: 1.8; min-height: 60vh; }
        #note-title:focus, #note-content:focus { outline: none; }
        [contenteditable]:empty:before { content: attr(placeholder); color: var(--secondary-text); }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: var(--primary-bg); padding: 20px; border-radius: 12px; width: 90%; max-width: 600px; max-height: 80vh; display: flex; flex-direction: column; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .modal-header h2 { font-size: 1.5rem; }
        .modal-close-btn { font-size: 1.5rem; border: none; background: none; cursor: pointer; }
        .modal-body { flex-grow: 1; overflow-y: auto; }
        .new-folder-form { display: flex; gap: 10px; margin-bottom: 20px; }
        .new-folder-form input { flex-grow: 1; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; }
        .new-folder-form button { padding: 10px 20px; border: none; background-color: var(--accent-color); color: white; border-radius: 6px; cursor: pointer; }
        #folder-list, #note-list-modal { list-style: none; padding: 0; }
        .folder-item { display: flex; align-items: center; gap: 10px; padding: 15px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; background: var(--secondary-bg); font-weight: 500; }
        .folder-item:not(.selection-mode):hover { background-color: var(--accent-color); color: white; }
        .folder-item.uncategorized { border: 1px dashed var(--border-color); }
        .folder-item.uncategorized svg { color: var(--secondary-text); }
        .folder-item svg { width: 24px; height: 24px; flex-shrink: 0; }
        .note-item { display: flex; align-items: center; justify-content: space-between; gap: 10px; padding: 15px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; background: var(--secondary-bg); font-weight: 500; }
        .note-item:hover { background-color: var(--accent-color); color: white; }
        .note-item .note-title-span { flex-grow: 1; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .delete-note-item-btn { background: none; border: none; color: var(--danger-color); font-size: 1.1rem; cursor: pointer; padding: 5px; display: none; border-radius: 50%; }
        .note-item:hover .delete-note-item-btn { display: block; }
        .delete-note-item-btn:hover { background-color: rgba(0,0,0,0.1); }
        #back-to-folders-modal-btn { margin-bottom: 10px; background-color: var(--secondary-bg); border: none; padding: 10px; border-radius: 6px; cursor: pointer; }
        #new-note-in-folder-btn { float: right; margin-bottom: 10px; background-color: var(--accent-color); color: white; border: none; padding: 10px 15px; border-radius: 6px; cursor: pointer; }
        .modal-footer { margin-top: 20px; padding-top: 10px; border-top: 1px solid var(--border-color); display: flex; justify-content: flex-end; gap: 10px; }
        .manage-btn { padding: 8px 16px; border: 1px solid var(--border-color); background: var(--secondary-bg); border-radius: 6px; cursor: pointer; font-weight: 500; }
        .delete-selected-btn { background-color: var(--danger-color); color: white; border-color: transparent; }
        .hidden { display: none; }
        .folder-item.selection-mode { padding-left: 10px; cursor: default; }
        .folder-item.selection-mode:hover { background-color: var(--secondary-bg); color: var(--primary-text); }
        .folder-item input[type="checkbox"] { margin-right: 10px; width: 18px; height: 18px; accent-color: var(--accent-color); }
        .feedback-form { display: flex; flex-direction: column; gap: 15px; }
        .feedback-form label { font-weight: 500; color: var(--secondary-text); }
        .feedback-form input, .feedback-form textarea { width: 100%; padding: 10px; border: 1px solid var(--border-color); border-radius: 6px; font-family: 'Poppins', sans-serif; font-size: 1rem; background-color: var(--secondary-bg); color: var(--primary-text); }
        .feedback-form textarea { min-height: 120px; resize: vertical; }
        .feedback-form button { padding: 12px; border: none; background-color: var(--accent-color); color: white; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: 500; }
        .developer-credit { text-align: center; margin-top: 30px; padding-top: 15px; border-top: 1px solid var(--border-color); font-size: 0.9rem; color: var(--secondary-text); }
    </style>
</head>
<body>
    <header class="app-header">
        <button id="new-note-btn" title="New Uncategorized Note">üìù</button>
        <button id="open-modal-btn" title="Open Folders/Notes">üìÇ</button>
        <span id="save-status">Saved</span>
        <div class="header-group-right">
            <button id="delete-note-btn" title="Delete">üóëÔ∏è</button>
            <button id="feedback-btn" title="Give Feedback">üí¨</button>
            <button id="dark-mode-btn" title="Toggle Dark Mode">üåô</button>
        </div>
    </header>
    <main class="main-editor">
        <div class="editor-content-wrapper">
            <input type="text" id="note-title" placeholder="Your Title Here...">
            <div id="formatting-toolbar">
                <button id="undo-btn" title="Undo">‚Ü©Ô∏è</button> <button id="redo-btn" title="Redo">‚Ü™Ô∏è</button>
                <div class="toolbar-separator"></div>
                <button id="bold-btn"><b>B</b></button> <button id="italic-btn"><i>I</i></button>
                <button id="underline-btn"><u>U</u></button> <button id="strike-btn"><s>S</s></button>
                <div class="toolbar-separator"></div>
                <button id="h1-btn">H1</button> <button id="h2-btn">H2</button>
                <button id="ul-btn">UL</button> <button id="ol-btn">OL</button>
            </div>
            <div id="note-content" contenteditable="true" placeholder="Start writing..."></div>
        </div>
    </main>
    <div id="file-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header"> <h2 id="modal-title">Folders</h2> <button class="modal-close-btn">&times;</button> </div>
            <div class="modal-body">
                <div id="modal-folder-view">
                    <div class="new-folder-form"> <input type="text" id="new-folder-name" placeholder="Create New Folder..."><button id="create-folder-btn">Create</button> </div>
                    <ul id="folder-list"></ul>
                </div>
                <div id="modal-note-list-view" style="display: none;">
                    <button id="back-to-folders-modal-btn">&leftarrow; Back to Folders</button>
                    <button id="new-note-in-folder-btn">+ New Note</button>
                    <ul id="note-list-modal"></ul>
                </div>
            </div>
            <div class="modal-footer">
                <button id="delete-selected-folders-btn" class="manage-btn delete-selected-btn hidden">Delete Selected</button>
                <button id="manage-folders-btn" class="manage-btn">Manage Folders</button>
                <button id="done-managing-btn" class="manage-btn hidden">Done</button>
            </div>
        </div>
    </div>
    <div id="feedback-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Share Your Feedback</h2>
                <button class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="feedback-form" class="feedback-form">
                    <div>
                        <label for="feedback-subject">Subject</label>
                        <input type="text" id="feedback-subject" name="subject" required>
                    </div>
                    <div>
                        <label for="feedback-message">Your Message</label>
                        <textarea id="feedback-message" name="message" required></textarea>
                    </div>
                    <button type="submit">Send Feedback via Email</button>
                </form>
                <div class="developer-credit">
                    Developed by <strong>RiseMaun</strong>
                </div>
            </div>
        </div>
    </div>
                <script>
    document.addEventListener('DOMContentLoaded', () => {
        const getNotes = () => JSON.parse(localStorage.getItem('notebook-notes-v12') || '[]');
        const saveNotes = (notes) => localStorage.setItem('notebook-notes-v12', JSON.stringify(notes));
        const getFolders = () => JSON.parse(localStorage.getItem('notebook-folders-v12') || '[]');
        const saveFolders = (folders) => localStorage.setItem('notebook-folders-v12', JSON.stringify(folders));

        const noteTitleEl = document.getElementById('note-title');
        const noteContentEl = document.getElementById('note-content');
        const saveStatusEl = document.getElementById('save-status');
        const modal = document.getElementById('file-modal');
        const modalTitle = document.getElementById('modal-title');
        const folderView = document.getElementById('modal-folder-view');
        const noteListView = document.getElementById('modal-note-list-view');
        const manageFoldersBtn = document.getElementById('manage-folders-btn');
        const doneManagingBtn = document.getElementById('done-managing-btn');
        const deleteSelectedBtn = document.getElementById('delete-selected-folders-btn');
        const feedbackModal = document.getElementById('feedback-modal');
        const feedbackBtn = document.getElementById('feedback-btn');
        const feedbackForm = document.getElementById('feedback-form');

        let AppState = { activeNoteId: null, activeFolder: null };
        let saveTimeout;
        const UNCATEGORIZED_FOLDER_NAME = "Uncategorized";
        const FOLDER_ICON_SVG = `<svg viewBox="0 0 24 24" fill="currentColor"><path d="M4 4h7l2 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"></path></svg>`;
        const UNCATEGORIZED_ICON_SVG = `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V6h5.17l2 2H20v10zm-8-4h2v2h-2v-2zm-4 0h2v2H8v-2zm8 0h2v2h-2v-2z"></path></svg>`;

        const renderFolders = () => {
            const folders = getFolders();
            const folderList = document.getElementById('folder-list');
            folderList.innerHTML = '';
            const uncategorizedLi = document.createElement('li');
            uncategorizedLi.className = 'folder-item uncategorized';
            uncategorizedLi.dataset.folderName = UNCATEGORIZED_FOLDER_NAME;
            uncategorizedLi.innerHTML = `${UNCATEGORIZED_ICON_SVG}<span>${UNCATEGORIZED_FOLDER_NAME}</span>`;
            folderList.appendChild(uncategorizedLi);
            folders.forEach(name => {
                const li = document.createElement('li');
                li.className = 'folder-item';
                li.dataset.folderName = name;
                li.innerHTML = `<input type="checkbox" class="folder-checkbox hidden">${FOLDER_ICON_SVG}<span>${name}</span>`;
                folderList.appendChild(li);
            });
        };

        const renderNotesInFolder = (folderName) => {
            modalTitle.textContent = folderName;
            AppState.activeFolder = folderName;
            let notesInFolder = (folderName === UNCATEGORIZED_FOLDER_NAME) ? getNotes().filter(n => !n.folder) : getNotes().filter(n => n.folder === folderName);
            const noteList = document.getElementById('note-list-modal');
            noteList.innerHTML = '';
            notesInFolder.sort((a,b) => b.id - a.id).forEach(note => {
                const li = document.createElement('li');
                li.className = 'note-item';
                li.dataset.noteId = note.id;
                li.innerHTML = `<span class="note-title-span">${note.title}</span><button class="delete-note-item-btn" title="Delete Note">üóëÔ∏è</button>`;
                noteList.appendChild(li);
            });
            folderView.style.display = 'none';
            noteListView.style.display = 'block';
        };
        
        const openNote = (noteId) => {
            const note = getNotes().find(n => n.id == noteId);
            if (note) { AppState.activeNoteId = note.id; AppState.activeFolder = note.folder; noteTitleEl.value = note.title; noteContentEl.innerHTML = note.content; modal.style.display = 'none'; }
        };
        const createNewNote = (folderName = null) => {
            const newNote = { id: Date.now(), title: "Untitled Note", content: "", folder: folderName };
            let notes = getNotes();
            notes.push(newNote);
            saveNotes(notes);
            openNote(newNote.id);
        };
        const autoSaveChanges = () => {
            if (!AppState.activeNoteId) return;
            saveStatusEl.textContent = "Saving...";
            const title = noteTitleEl.value.trim();
            const content = noteContentEl.innerHTML;
            let notes = getNotes();
            const noteToUpdate = notes.find(n => n.id == AppState.activeNoteId);
            if (noteToUpdate) { noteToUpdate.title = title || "Untitled Note"; noteToUpdate.content = content; saveNotes(notes); setTimeout(() => { saveStatusEl.textContent = "Saved"; }, 1000); }
        };
        const debouncedSave = () => { clearTimeout(saveTimeout); saveTimeout = setTimeout(autoSaveChanges, 1500); };
        const toggleManagementMode = (isManaging) => {
            const folderItems = document.querySelectorAll('#folder-list .folder-item:not(.uncategorized)');
            const checkboxes = document.querySelectorAll('.folder-checkbox');
            manageFoldersBtn.classList.toggle('hidden', isManaging);
            doneManagingBtn.classList.toggle('hidden', !isManaging);
            folderItems.forEach(item => item.classList.toggle('selection-mode', isManaging));
            checkboxes.forEach(cb => cb.classList.toggle('hidden', !isManaging));
            if (!isManaging) { checkboxes.forEach(cb => cb.checked = false); deleteSelectedBtn.classList.add('hidden'); }
        };

        document.getElementById('open-modal-btn').addEventListener('click', () => {
            modalTitle.textContent = "Folders";
            folderView.style.display = 'block';
            noteListView.style.display = 'none';
            toggleManagementMode(false);
            renderFolders();
            modal.style.display = 'flex';
        });
        
        document.querySelectorAll('.modal-close-btn').forEach(btn => {
            btn.addEventListener('click', () => btn.closest('.modal-overlay').style.display = 'none');
        });

        document.getElementById('create-folder-btn').addEventListener('click', () => {
            const input = document.getElementById('new-folder-name');
            const newName = input.value.trim();
            if (newName && newName.toLowerCase() !== UNCATEGORIZED_FOLDER_NAME.toLowerCase()) {
                let folders = getFolders();
                if (!folders.find(f => f.toLowerCase() === newName.toLowerCase())) { folders.push(newName); saveFolders(folders); renderFolders(); input.value = ''; }
                else { alert('Folder with this name already exists.'); }
            } else { alert('Invalid folder name.'); }
        });

        document.getElementById('folder-list').addEventListener('click', e => {
            const isManaging = !manageFoldersBtn.classList.contains('hidden');
            if (isManaging) return;
            const folderItem = e.target.closest('.folder-item');
            if (folderItem) renderNotesInFolder(folderItem.dataset.folderName);
        });
        
        document.getElementById('folder-list').addEventListener('change', e => {
            if (e.target.classList.contains('folder-checkbox')) {
                const anyChecked = Array.from(document.querySelectorAll('.folder-checkbox')).some(cb => cb.checked);
                deleteSelectedBtn.classList.toggle('hidden', !anyChecked);
            }
        });

        manageFoldersBtn.addEventListener('click', () => toggleManagementMode(true));
        doneManagingBtn.addEventListener('click', () => toggleManagementMode(false));
        deleteSelectedBtn.addEventListener('click', () => {
            const selectedFolders = Array.from(document.querySelectorAll('.folder-checkbox:checked')).map(cb => cb.closest('.folder-item').dataset.folderName);
            if (selectedFolders.length === 0) return;
            if (confirm(`Delete ${selectedFolders.length} folder(s)? Notes inside will become uncategorized.`)) {
                let folders = getFolders().filter(f => !selectedFolders.includes(f));
                saveFolders(folders);
                let notes = getNotes();
                notes.forEach(note => { if (selectedFolders.includes(note.folder)) { note.folder = null; } });
                saveNotes(notes);
                renderFolders();
                toggleManagementMode(false);
            }
        });

        document.getElementById('back-to-folders-modal-btn').addEventListener('click', () => { modalTitle.textContent = "Folders"; folderView.style.display = 'block'; noteListView.style.display = 'none'; });
        document.getElementById('new-note-in-folder-btn').addEventListener('click', () => createNewNote(AppState.activeFolder === UNCATEGORIZED_FOLDER_NAME ? null : AppState.activeFolder));
        document.getElementById('note-list-modal').addEventListener('click', e => {
            const noteItem = e.target.closest('.note-item');
            if (!noteItem) return;
            const noteId = noteItem.dataset.noteId;
            if (e.target.classList.contains('delete-note-item-btn')) {
                e.stopPropagation();
                if (confirm(`Delete ${selectedFolders.length} folder(s)? Notes inside will become uncategorized.`)) {
    let folders = getFolders().filter(f => !selectedFolders.includes(f));
    saveFolders(folders);
    let notes = getNotes();
    notes.forEach(note => { if (selectedFolders.includes(note.folder)) { note.folder = null; } });
    saveNotes(notes);
    renderFolders();
    toggleManagementMode(false);
                }
            } else { openNote(noteId); }
        });

        document.getElementById('new-note-btn').addEventListener('click', () => createNewNote(null));
        document.getElementById('delete-note-btn').addEventListener('click', () => {
            if (AppState.activeNoteId && confirm("Delete this note permanently?")) {
                let notes = getNotes().filter(n => n.id != AppState.activeNoteId);
                saveNotes(notes); AppState.activeNoteId = null; noteTitleEl.value = ''; noteContentEl.innerHTML = '';
            }
        });
        
        const darkModeBtn = document.getElementById('dark-mode-btn');
        darkModeBtn.addEventListener('click', () => { document.body.classList.toggle('dark-mode'); localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light'); });
        if (localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');

        const formatText = (command, value = null) => { document.execCommand(command, false, value); noteContentEl.focus(); };
        const formatButtons = [ { id: 'undo-btn', command: 'undo' }, { id: 'redo-btn', command: 'redo' }, { id: 'bold-btn', command: 'bold' }, { id: 'italic-btn', command: 'italic' }, { id: 'underline-btn', command: 'underline' }, { id: 'strike-btn', command: 'strikeThrough' }, { id: 'h1-btn', command: 'formatBlock', value: 'h1' }, { id: 'h2-btn', command: 'formatBlock', value: 'h2' }, { id: 'ul-btn', command: 'insertUnorderedList' }, { id: 'ol-btn', command: 'insertOrderedList' }];
        formatButtons.forEach(btn => { document.getElementById(btn.id).addEventListener('mousedown', e => { e.preventDefault(); formatText(btn.command, btn.value); }); });
        
        feedbackBtn.addEventListener('click', () => { feedbackModal.style.display = 'flex'; });
        feedbackForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const subject = document.getElementById('feedback-subject').value;
            const message = document.getElementById('feedback-message').value;
            const mailtoLink = `mailto:sonalisaddu@gmail.com?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(message)}`;
            window.location.href = mailtoLink;
            feedbackModal.style.display = 'none';
        });

        noteTitleEl.addEventListener('input', debouncedSave);
        noteContentEl.addEventListener('input', debouncedSave);

        if (getFolders().length === 0 && getNotes().length === 0) { saveFolders(['My First Folder']); createNewNote('My First Folder'); } 
        else { const notes = getNotes(); if (notes.length > 0) openNote(notes.sort((a,b) => b.id - a.id)[0].id); else createNewNote(null); }
    });
    </script>
</body>
</html>
